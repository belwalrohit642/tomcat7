--- 
- name: install tomcat7 using ansible
  hosts: demo
  become: true
  tasks:
          - name: update the system packages
            package:
                    upgrade: yes
                    update_cache: yes
          - name: create a tomcat group
            user:
                    name: tomcat
          - name: create a tomcat user
            group:
                    name: tomcat
          - name: install java
            package:
                    name: default-jdk
                    state: present
          - name: Create a Tomcat Directory
            file:
             path: /opt/tomcat7
             owner: tomcat
             group: tomcat
             mode: 755
             recurse: yes        
         - name: download & unarchive tomcat7
           unarchive:
             src: http://www-us.apache.org/dist/tomcat/tomcat-7/v7.0.99/bin/apache-tomcat-7.0.99.tar.gz
             dest: /opt/tomcat7
             remote_src: yes
             extra_opts: [--strip-components=1]
         - name: Change ownership of tomcat directory
           file:
             path: /opt/tomcat7
             owner: tomcat
             group: tomcat
             mode: "u+rwx,g+rx,o=rx"
             recurse: yes
             state: directory
         - name: Copy Tomcat service from local to remote
           copy:
            src: /etc/tomcat.service
            dest: /etc/systemd/system/
            mode: 0755

         - name: Start and Enable Tomcat 7 on sever
           systemd:
             name: tomcat
             state: started
             daemon_reload: true

